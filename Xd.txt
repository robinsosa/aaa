-- Tabla LIBRERIA_AUTOR 
CREATE TABLE LIBRERIA_AUTOR 
    ( 
     ID_Autor       INTEGER  NOT NULL , 
     Nombre_Autor   NVARCHAR2 (50)  NOT NULL , 
     Apellido_Autor NVARCHAR2 (50)  NOT NULL , 
     Fecha_Nacimi   DATE  NOT NULL , 
     Lugar_Natal    NVARCHAR2 (100)  NOT NULL 
    ) 
;

ALTER TABLE LIBRERIA_AUTOR 
    ADD CONSTRAINT LIBRERIA_AUTOR_PK PRIMARY KEY ( ID_Autor ) ;

-- Tabla LIBRERIA_CLIENTE
CREATE TABLE LIBRERIA_CLIENTE 
    ( 
     ID_Cliente       INTEGER  NOT NULL , 
     Nombre_Cliente   NVARCHAR2 (70)  NOT NULL , 
     Apellido_Cliente NVARCHAR2 (70)  NOT NULL , 
     Email            NVARCHAR2 (100) , 
     Telefono         NVARCHAR2 (15)  NOT NULL
    ) 
;

ALTER TABLE LIBRERIA_CLIENTE 
    ADD CONSTRAINT LIBRERIA_CLIENTE_PK PRIMARY KEY ( ID_Cliente ) ;

-- Tabla LIBRERIA_FORMA_PAGO
CREATE TABLE LIBRERIA_FORMA_PAGO 
    ( 
     ID_Forma_pago INTEGER  NOT NULL , 
     Nombre_Forma  NVARCHAR2(50) NOT NULL,
     Descripcion   NVARCHAR2(100)
    ) 
;

ALTER TABLE LIBRERIA_FORMA_PAGO 
    ADD CONSTRAINT LIBRERIA_FORMA_PAGO_PK PRIMARY KEY ( ID_Forma_pago ) ;

-- Tabla LIBRERIA_LIBRO
CREATE TABLE LIBRERIA_LIBRO 
    ( 
     ID_Libro       INTEGER  NOT NULL , 
     Titulo         NVARCHAR2 (100)  NOT NULL , 
     Precio         NUMBER (10,2)  NOT NULL ,
     Fecha_Publi    DATE  NOT NULL , 
     AUTOR_ID_Autor INTEGER  NOT NULL 
    ) 
;

ALTER TABLE LIBRERIA_LIBRO 
    ADD CONSTRAINT LIBRERIA_LIBRO_PK PRIMARY KEY ( ID_Libro ) ;

-- Tabla LIBRERIA_TRANSACCION
CREATE TABLE LIBRERIA_TRANSACCION 
    ( 
     ID_transac         INTEGER  NOT NULL , 
     Fecha_Transa       DATE  NOT NULL , 
     Total              NUMBER(10,2)  NOT NULL ,
     CLIENTE_ID_Cliente INTEGER  NOT NULL ,
     FORMA_PAGO_ID_Forma_pago INTEGER NOT NULL
    ) 
;

ALTER TABLE LIBRERIA_TRANSACCION 
    ADD CONSTRAINT LIBRERIA_TRANSACCION_PK PRIMARY KEY ( ID_transac ) ;

-- Tabla LIBRERIA_DETAL_TRANSA
CREATE TABLE LIBRERIA_DETAL_TRANSA 
    ( 
     ID_Delt_Transac        INTEGER  NOT NULL , 
     Cantidad               INTEGER  NOT NULL , 
     Precio_Unitario        NUMBER(10,2)  NOT NULL ,
     Subtotal               NUMBER(10,2)  NOT NULL ,
     LIBRO_ID_Libro         INTEGER  NOT NULL , 
     TRANSACCION_ID_transac INTEGER  NOT NULL 
    ) 
;

ALTER TABLE LIBRERIA_DETAL_TRANSA 
    ADD CONSTRAINT LIBRERIA_DETAL_TRANSA_PK PRIMARY KEY ( ID_Delt_Transac ) ;

-- CONSTRAINTS CORREGIDOS
ALTER TABLE LIBRERIA_DETAL_TRANSA 
    ADD CONSTRAINT LIBRERIA_DETAL_TRANSA_LIBRO_FK FOREIGN KEY 
    ( 
     LIBRO_ID_Libro
    ) 
    REFERENCES LIBRERIA_LIBRO 
    ( 
     ID_Libro
    ) 
;

ALTER TABLE LIBRERIA_DETAL_TRANSA 
    ADD CONSTRAINT LIBRERIA_DETAL_TRANSA_TRANSACCION_FK FOREIGN KEY 
    ( 
     TRANSACCION_ID_transac
    ) 
    REFERENCES LIBRERIA_TRANSACCION 
    ( 
     ID_transac
    ) 
;

ALTER TABLE LIBRERIA_LIBRO 
    ADD CONSTRAINT LIBRERIA_LIBRO_AUTOR_FK FOREIGN KEY 
    ( 
     AUTOR_ID_Autor
    ) 
    REFERENCES LIBRERIA_AUTOR 
    ( 
     ID_Autor
    ) 
;

ALTER TABLE LIBRERIA_TRANSACCION 
    ADD CONSTRAINT LIBRERIA_TRANSACCION_CLIENTE_FK FOREIGN KEY 
    ( 
     CLIENTE_ID_Cliente
    ) 
    REFERENCES LIBRERIA_CLIENTE 
    ( 
     ID_Cliente
    ) 
;

ALTER TABLE LIBRERIA_TRANSACCION 
    ADD CONSTRAINT LIBRERIA_TRANSACCION_FORMA_PAGO_FK FOREIGN KEY 
    ( 
     FORMA_PAGO_ID_Forma_pago
    ) 
    REFERENCES LIBRERIA_FORMA_PAGO 
    ( 
     ID_Forma_pago
    ) 
;
